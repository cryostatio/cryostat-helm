suite: test db_service.yaml
templates:
  - db_service.yaml

tests:
  - it: should create a Service with the correct settings
    set:
      db.service.type: ClusterIP
      db.service.port: 8080
      authentication.openshift.enabled: false
    asserts:
      - hasDocuments:
          count: 1
      - equal:
          path: kind
          value: Service
      - equal:
          path: metadata.name
          value: RELEASE-NAME-cryostat-db
      - equal:
          path: spec.type
          value: ClusterIP
      - equal:
          path: spec.ports[0].port
          value: 8080
      - equal:
          path: metadata.labels
          value:
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: cryostat
            app.kubernetes.io/version: "4.0.0-dev"
            helm.sh/chart: cryostat-2.0.0-dev
